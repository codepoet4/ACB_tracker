<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Board Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ôü Chess Board Analyzer</h1>
            <p>Analyze chess positions and get AI-powered move suggestions</p>
        </header>

        <main>
            <div class="content-wrapper">
                <!-- Input Panel -->
                <div class="input-panel">
                    <div class="card">
                        <h2>Input Options</h2>
                        
                        <!-- Board Orientation Selection -->
                        <div class="form-group">
                            <label>Board Orientation:</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="perspective" value="white" checked>
                                    <span>White at bottom</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="perspective" value="black">
                                    <span>Black at bottom</span>
                                </label>
                            </div>
                        </div>

                        <!-- Side Selection -->
                        <div class="form-group">
                            <label>Move for:</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="side" value="white" checked>
                                    <span>White</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="side" value="black">
                                    <span>Black</span>
                                </label>
                            </div>
                        </div>

                        <!-- Analyze Button -->
                        <button id="analyzeBtn" class="btn btn-primary" onclick="analyzeBoard()" style="width: 100%;">
                            ‚ú® Analyze Board
                        </button>

                        <div class="tabs">
                            <button class="tab-button active" data-tab="image">üì∑ Upload Image</button>
                            <button class="tab-button" data-tab="fen">üìù Enter FEN</button>
                        </div>

                        <!-- Image Upload Tab -->
                        <div id="image-tab" class="tab-content active">
                            <div class="upload-area-compact" id="uploadArea">
                                <input type="file" id="imageInput" accept="image/*" hidden>
                                <button class="btn btn-secondary btn-small" id="chooseImageBtn">
                                    Choose Image
                                </button>
                                <p class="small">or drag and drop</p>
                            </div>
                            <div id="imagePreview" class="image-preview-compact" style="display: none;">
                                <img id="previewImg" src="" alt="Preview">
                            </div>
                            <div id="detectedFenContainer" style="display: none; margin-top: 10px;">
                                <div class="form-group">
                                    <label>Detected FEN:</label>
                                    <div style="background: #f5f5f5; padding: 8px; border-radius: 4px; word-break: break-all; font-family: monospace; font-size: 11px;">
                                        <code id="detectedFen"></code>
                                    </div>
                                    <button class="btn btn-small" id="copyFenBtn" style="margin-top: 6px;">Copy FEN</button>
                                </div>
                            </div>
                        </div>

                        <!-- FEN Input Tab -->
                        <div id="fen-tab" class="tab-content">
                            <div class="form-group">
                                <label for="fenInput">FEN Notation:</label>
                                <textarea id="fenInput" placeholder="e.g., rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1" rows="3"></textarea>
                                <button class="btn btn-secondary" onclick="loadStartingPosition()">Load Starting Position</button>
                            </div>
                        </div>

                        <button id="displayFenBtn" class="btn btn-secondary" onclick="displayFenFromImage()" style="display: none;">
                            üìã Display FEN from Image
                        </button>
                        
                        <div id="loadingIndicator" class="loading" style="display: none;">
                            <div class="spinner"></div>
                            <p>Analyzing position...</p>
                        </div>
                    </div>
                </div>

                <!-- Results Panel -->
                <div class="results-panel">
                    <div class="card">
                        <h2>Analysis Results</h2>
                        
                        <div id="resultsContent" style="display: none;">
                            <!-- Best Move -->
                            <div class="result-item highlight">
                                <label>Best Move:</label>
                                <div class="best-move-display">
                                    <div class="move-notation" id="resultMove"></div>
                                    <div class="move-algebraic" id="resultMoveSan"></div>
                                </div>
                            </div>

                            <!-- Legal Moves -->
                            <div class="result-item" id="movesContainer" style="display: none;">
                                <label>Top 10 Legal Moves:</label>
                                <div id="resultMoves" class="moves-list"></div>
                            </div>
                        </div>

                        <div id="errorContent" style="display: none;">
                            <div class="error-message">
                                <p id="errorText"></p>
                            </div>
                        </div>

                        <div id="noResultsContent" class="no-results">
                            <p>üëà Upload an image or enter a FEN to analyze</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Chess Board Analyzer v1.0 | Powered by Stockfish Engine</p>
            <p class="info">This tool analyzes chess positions using the free Stockfish engine</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
